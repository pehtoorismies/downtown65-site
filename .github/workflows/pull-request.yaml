name: Pull Request

on:
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:

concurrency:
  group: pr-${{ github.event.pull_request.number }}
  cancel-in-progress: true

jobs:
#   quality-checks:
#     uses: ./.github/workflows/quality-checks.yaml
#     secrets: inherit

  deploy-preview:
    uses: ./.github/workflows/deploy-preview.yaml
    with:
      pr-number: ${{ github.event.pull_request.number }}
    secrets: inherit


#   comment-pr:
#     needs: [deploy-preview, quality-checks]
#     runs-on: ubuntu-22.04
#     steps:
#       - uses: actions/github-script@v7
#         with:
#           script: |
#             github.rest.issues.createComment({
#               issue_number: context.issue.number,
#               owner: context.repo.owner,
#               repo: context.repo.repo,
#               body: `ðŸš€ Preview deployed!\n\n**Backend**: ${{ needs.deploy-preview.outputs.backend-url }}\n**Frontend**: ${{ needs.deploy-preview.outputs.frontend-url }}\n\nâœ… All checks passed!`
#             })